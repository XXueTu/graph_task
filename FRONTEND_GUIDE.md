# Task Graph 前端使用指南

## 🌟 概述

Task Graph 提供了一个现代化的 Web 界面，用于管理和监控任务执行的整个生命周期。界面包含四个主要功能模块，其中 **追踪视图** 是核心功能，提供了详细的任务执行trace分析。

## 🚀 启动应用

```bash
# 启动后端服务
go run .

# 访问前端页面
打开浏览器访问: http://localhost:8080
```

## 📋 功能模块

### 1. 📊 追踪视图（Trace页面）- 核心功能

这是您要求的主要功能：**左侧显示span列表，点击后右侧显示详细信息**。

#### 🔍 如何使用：

1. **切换到追踪视图**
   - 点击顶部导航的 "追踪视图" 标签

2. **加载执行追踪**
   - 在页面顶部输入框中输入 `执行ID`
   - 点击 "加载追踪" 按钮

3. **查看Span列表（左侧）**
   ```
   左侧显示所有任务的span信息：
   🟢 成功任务 - 绿色圆点
   🔴 失败任务 - 红色圆点  
   🟡 运行中任务 - 黄色圆点（带动画效果）
   ⚪ 等待任务 - 灰色圆点
   
   每个span显示：
   - 任务名称
   - 执行状态
   - 执行时长
   - 开始时间
   ```

4. **查看详细信息（右侧）**
   ```
   点击左侧任意span，右侧会显示：
   
   📋 任务信息：
   - 任务ID、名称、状态
   - 开始时间、结束时间、执行时长
   
   📥 输入参数：
   - JSON格式显示任务输入
   - 深色代码块，语法高亮
   
   📤 输出结果：
   - JSON格式显示任务输出
   - 结构化数据展示
   
   ❌ 错误信息（如果有）：
   - 红色背景突出显示
   - 详细的错误堆栈信息
   ```

#### 🎨 界面特性：

- **响应式设计**：支持不同屏幕尺寸
- **实时状态**：动态更新执行状态
- **交互反馈**：悬停效果、选中高亮
- **时间格式化**：自动转换为可读时间格式
- **状态徽章**：彩色状态标识

### 2. 📋 工作流管理

管理和查看工作流定义：

- **工作流列表**：显示所有可用工作流
- **工作流详情**：查看任务依赖关系
- **执行工作流**：启动新的工作流执行
- **搜索过滤**：快速查找特定工作流

### 3. ⚡ 执行记录

监控工作流执行状态：

- **执行列表**：显示所有执行记录
- **执行详情**：查看执行进度和结果
- **状态过滤**：按状态筛选执行记录
- **操作控制**：重试失败执行、取消运行中执行

### 4. 🔄 失败重试

管理失败的执行：

- **失败列表**：显示所有失败的执行
- **批量重试**：一键重试多个失败执行
- **错误分析**：查看失败原因

## 🎯 典型使用流程

### 追踪分析工作流

1. **创建/执行工作流**
   ```
   工作流管理 → 选择工作流 → 执行工作流
   ```

2. **监控执行进度**
   ```
   执行记录 → 查看执行状态 → 监控进度条
   ```

3. **深度分析执行轨迹**
   ```
   追踪视图 → 输入执行ID → 加载追踪
   ↓
   左侧：浏览所有span
   ↓  
   右侧：点击查看详细输入输出
   ```

4. **问题排查**
   ```
   识别失败的span → 查看错误信息 → 分析输入参数
   ↓
   失败重试 → 重新执行
   ```

## 🛠️ API接口

前端与后端通过REST API通信：

```javascript
// 主要API端点
GET  /api/workflows           // 获取工作流列表
GET  /api/workflows/{id}      // 获取工作流详情
GET  /api/executions          // 获取执行列表
GET  /api/executions/{id}     // 获取执行详情
GET  /api/traces/{id}         // 获取执行追踪 ⭐ 核心API
POST /api/execute             // 执行工作流
POST /api/retry               // 重试执行
POST /api/cancel              // 取消执行
```

## 🎨 界面截图说明

### 追踪视图页面结构：
```
┌─────────────────────────────────────────────────────────┐
│ 🏠 Task Graph        [工作流][执行记录][追踪视图][失败重试] │
├─────────────────────────────────────────────────────────┤
│ 执行追踪                    [执行ID输入框] [加载追踪]     │
├──────────────────┬──────────────────────────────────────┤
│ 📋 任务列表      │ 📊 任务详情                           │
│ 总时间: 2.5s     │                                      │
│ 状态: completed  │                                      │
├──────────────────┤                                      │
│ 🟢 task1         │ 📋 任务信息                          │
│    status: ✓     │ 任务ID: span-123                     │
│    时长: 1.2s    │ 状态: [SUCCESS]                      │
│    开始: 14:30   │                                      │
├──────────────────┤ 📥 输入参数                          │
│ 🟡 task2         │ {                                    │
│    status: ⏳    │   "input": "value",                  │
│    时长: 0.8s    │   "config": {...}                   │
│    开始: 14:31   │ }                                    │
├──────────────────┤                                      │
│ 🔴 task3         │ 📤 输出结果                          │
│    status: ✗     │ {                                    │
│    时长: 0.5s    │   "result": "success",               │
│    开始: 14:32   │   "data": {...}                     │
└──────────────────┴──────────────────────────────────────┘
```

## 🔧 技术特性

- **框架**：纯JavaScript + CSS3
- **设计**：现代化扁平设计
- **响应式**：移动端适配
- **性能**：异步加载、懒渲染
- **用户体验**：加载状态、错误提示、键盘快捷键

## 📱 移动端支持

- 响应式布局，自动适配手机屏幕
- 触摸友好的交互设计
- 简化导航，折叠侧边栏

## 🎯 快捷键

- `Ctrl/Cmd + R`：刷新当前页面数据
- `Escape`：关闭模态框
- `Tab`：在表单元素间切换

---

## 💡 使用技巧

1. **快速定位问题**：在追踪视图中，红色圆点表示失败的任务，优先查看这些span
2. **性能分析**：通过执行时长对比，识别性能瓶颈
3. **数据流跟踪**：通过输入输出参数，跟踪数据在任务间的传递
4. **批量操作**：在失败重试页面，可以批量重试多个失败的执行

这个前端界面完全实现了您要求的功能：**左侧span列表，点击后右侧显示详细输入输出信息**，并且提供了完整的任务生命周期管理功能。 